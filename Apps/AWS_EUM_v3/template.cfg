Application: AWS End User Messaging (EUM) v3.0.4
Name: AWS_EUM_v3
Version: 3.0.4
Author: N85UK
Description: Enhanced AWS SMS application with dark mode, Chart.js analytics, and configurable CSP for all network types. Automatically discovers phone numbers and supports long messages.
Overview: AWS End User Messaging (EUM) v3.0.4 features automatic AWS phone number discovery, Chart.js analytics with fixed expansion issues, dark/light mode toggle, intelligent message segmentation (up to 1600 characters), and configurable Content Security Policy for seamless operation on custom bridge networks.&#xD;&#xA;&#xD;&#xA;Key Features:&#xD;&#xA;• Modern UI with dark mode and stable Chart.js analytics&#xD;&#xA;• Fixed chart expansion issues in v3.0.4&#xD;&#xA;• Configurable CSP - fixes br0.2, br0.100, custom networks&#xD;&#xA;• Automatic AWS phone number detection&#xD;&#xA;• Long message support with auto-segmentation&#xD;&#xA;• Real-time cost estimation and history tracking&#xD;&#xA;• Rate limiting and security features&#xD;&#xA;• Full UNRAID Community Applications integration&#xD;&#xA;&#xD;&#xA;Perfect for notifications, alerts, and personal messaging. Just add AWS credentials and optionally set DISABLE_CSP=true for custom networks.&#xD;&#xA;&#xD;&#xA;Requires: AWS account with SMS permissions and phone numbers in AWS Pinpoint SMS.
Repository: ghcr.io/n85uk/aws-eum-v3:3.0.4

WebUI: http://[IP]:[PORT:80]
Icon: https://raw.githubusercontent.com/N85UK/UNRAID_Apps/main/Apps/AWS_EUM_v3/images/aws-eum-icon.png

Network: bridge
Privileged: false

# Additional Requirements
Requires: Valid AWS account with SMS/Pinpoint access, AWS Access Key with SMS permissions, At least one phone number or sender ID configured in AWS Pinpoint
MinRam: 256MB
MaxRam: 512MB
MinCpu: 0.5
MaxCpu: 1.0

# Auto-Update Configuration
UpdateURL: https://api.github.com/repos/N85UK/UNRAID_Apps/releases/latest
Changelog: https://github.com/N85UK/UNRAID_Apps/blob/main/Apps/AWS_EUM_v3/CHANGELOG.md
AutoUpdate: true
Beta: false

# Documentation and Support
Project: https://github.com/N85UK/UNRAID_Apps/tree/main/Apps/AWS_EUM_v3
Support: https://github.com/N85UK/UNRAID_Apps/issues
ReadMe: https://github.com/N85UK/UNRAID_Apps/blob/main/Apps/AWS_EUM_v3/README.md
Documentation: https://github.com/N85UK/UNRAID_Apps/blob/main/Apps/AWS_EUM_v3/CSP_TROUBLESHOOTING.md

Config:
  - name: AWS Configuration
    type: label
    description: Configure your AWS credentials and region
  
  - name: AWS_ACCESS_KEY_ID
    label: AWS Access Key ID
    env: AWS_ACCESS_KEY_ID
    default: ''
    description: Your AWS access key ID (required for AWS services)
    required: true
    type: password
    mask: true
  
  - name: AWS_SECRET_ACCESS_KEY
    label: AWS Secret Access Key
    env: AWS_SECRET_ACCESS_KEY
    default: ''
    description: Your AWS secret access key (keep secure!)
    required: true
    type: password
    mask: true
  
  - name: AWS_REGION
    label: AWS Region
    env: AWS_REGION
    default: 'eu-west-2'
    description: AWS region where your SMS resources are located
    type: variable
    options:
      - us-east-1
      - us-west-2
      - eu-west-1
      - eu-west-2
      - eu-central-1
      - ap-southeast-1
      - ap-southeast-2
      - ap-northeast-1
      - ca-central-1
  
  - name: Application Settings
    type: label
    description: Configure application behavior and security
  
  - name: PORT
    label: Application Port
    env: PORT
    default: '80'
    description: Internal container port (default 80)
    type: variable
  
  - name: RATE_LIMIT_MESSAGES
    label: Rate Limit (Messages/Minute)
    env: RATE_LIMIT_MESSAGES
    default: '10'
    description: Maximum SMS messages per minute per IP (prevents abuse)
    type: variable
  
  - name: MAX_MESSAGE_LENGTH
    label: Maximum Message Length
    env: MAX_MESSAGE_LENGTH
    default: '1600'
    description: Maximum characters allowed in a single message (SMS will auto-segment)
    type: variable
  
  - name: HISTORY_RETENTION
    label: Message History Retention
    env: HISTORY_RETENTION
    default: '100'
    description: Number of messages to keep in history
    type: variable
  
  - name: Manual Configuration (Optional)
    type: label
    description: Manual originator configuration (app auto-fetches from AWS)
  
  - name: ORIGINATORS
    label: Manual Originators
    env: ORIGINATORS
    default: ''
    description: Optional manual originators (format: Label1:arn1,Label2:arn2). App automatically fetches from AWS.
    type: variable
  
  - name: ENABLE_DEBUG
    label: Enable Debug Mode
    env: ENABLE_DEBUG
    default: 'false'
    description: Enable debug logging for troubleshooting
    type: boolean
    values:
      - value: 'true'
        label: 'Yes'
      - value: 'false'
        label: 'No'

  - name: Content Security Policy (CSP) Settings
    type: label
    description: Configure CSP for custom bridge networks (br0.2, br0.100, etc.)
  
  - name: DISABLE_CSP
    label: Disable CSP Headers
    env: DISABLE_CSP
    default: 'false'
    description: Disable CSP completely to allow external resources (recommended for br0.x networks)
    type: boolean
    values:
      - value: 'true'
        label: 'Yes - Allow all external resources'
      - value: 'false'
        label: 'No - Use security headers'
  
  - name: NETWORK_HOST
    label: Network Host (Optional)
    env: NETWORK_HOST
    default: 'http://10.0.2.11'
    description: Specify your network host/IP for CSP whitelist (e.g., http://192.168.2.1 for br0.2)
    type: variable
  
  - name: CSP_POLICY
    label: Custom CSP Policy (Advanced)
    env: CSP_POLICY
    default: ''
    description: Advanced: Custom CSP policy as JSON (leave empty for auto-configuration)
    type: variable

  - name: Auto-Update Settings
    type: label
    description: Configure automatic update behavior
  
  - name: AUTO_UPDATE_CHECK
    label: Enable Update Checking
    env: AUTO_UPDATE_CHECK
    default: 'true'
    description: Check for new versions automatically
    type: boolean
    values:
      - value: 'true'
        label: 'Yes'
      - value: 'false'
        label: 'No'
  
  - name: UPDATE_CHECK_INTERVAL
    label: Update Check Interval (hours)
    env: UPDATE_CHECK_INTERVAL
    default: '24'
    description: How often to check for updates (in hours)
    type: number
    min: 1
    max: 168
  
  - name: AUTO_UPDATE_APPLY
    label: Auto-Apply Updates
    env: AUTO_UPDATE_APPLY
    default: 'false'
    description: Automatically apply updates when found (requires Watchtower)
    type: boolean
    values:
      - value: 'true'
        label: 'Yes'
      - value: 'false'
        label: 'No'

Ports:
  - name: Web Interface
    internal: 80
    external: 8280
    protocol: tcp
    description: Web interface for sending SMS messages

Volumes:
  - name: Application Data
    internal: /app/data
    external: /mnt/user/appdata/aws-eum
    mode: rw
    description: Stores message history and application data

Notes:
  Enhanced Features v3.0.1:
  - Modern dark/light mode UI with Chart.js analytics
  - CSP fixes for custom bridge networks (br0.2, br0.100, etc.)
  - Automatic AWS phone number discovery
  - Long message support with auto-segmentation
  - Real-time cost estimation and history tracking
  - Rate limiting and security features
  
  Quick Setup:
  1. Install from Community Applications
  2. Add AWS Access Key ID and Secret Access Key
  3. Select AWS region
  4. For custom networks: Set "Disable CSP Headers" to "Yes"
  5. Access at http://[server-ip]:8280
  
  Network Fix:
  - Default bridge: Works automatically
  - Custom bridge (br0.x): Enable "Disable CSP Headers"
  - This fixes charts, dark mode, and icons not loading
  
  Security:
  - AWS credentials encrypted and stored securely
  - Rate limiting prevents abuse
  - Configurable CSP for network compatibility

PostArgs:
  - --restart=unless-stopped
  - --memory=512m
  - --cpu-shares=1024
